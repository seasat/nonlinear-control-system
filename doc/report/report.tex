\documentclass[a4paper, listof=totoc]{scrreport}
\usepackage{attitude_control}
\input{tex/symbols.tex}

\subject{Attitude Dynamics and Control (AE4313)}
\title{Nonlinear Spacecraft Attitude Control System Design}
\subtitle{Practical Exercise Project Assignment 2}
\author{Lars Bl√ºmler\\6149065}
\publishers{\includegraphics{tu_delft_logo.pdf}}


\begin{document}
% front matter
\maketitle
\pagenumbering{roman}
\tableofcontents
\listoffigures
\begingroup
    \let\clearpage\relax
    \listoftables
\endgroup
\clearpage


% main matter
\pagenumbering{arabic}
\chapter{Methodology}
\section{Coordinate Systems}
\subsection{Inertial Frame}
\input{tikz/inertial_frame.tex}
\input{tikz/lvlh_frame.tex}
\input{tikz/body_frame.tex}


\subsection{\texorpdfstring{\acrlong{lvlh}}{Local Vertical Local Horizontal} Frame}
\subsection{Body Frame}


\section{Attitude Representation}
\subsection{\texorpdfstring{\acrlong{ac:dcm}}{Direction Cosine Matrix}}
The \glsfull{sy:dcm} is a matrix that describes the linear transformation between two coordinate frames.
In three dimension, $\gls{sy:dcm} \in \mathbb{R}^{3 \times 3}$ and the definition is given by \cref{eqt:dcm}.
\begin{equation} \label{eqt:dcm}
    \gls{sy:dcm} = \begin{bmatrix}
        \gls{sy:dcm}_{11} & \gls{sy:dcm}_{12} & \gls{sy:dcm}_{13} \\
        \gls{sy:dcm}_{21} & \gls{sy:dcm}_{22} & \gls{sy:dcm}_{23} \\
        \gls{sy:dcm}_{31} & \gls{sy:dcm}_{32} & \gls{sy:dcm}_{33}
    \end{bmatrix}
\end{equation}

A transformation matrix $\gls{sy:dcm}^{B/A}$ from frame $A$ to frame $B$ is constructed from the basis vectors of frame $A$ ($\gls{sy:a}_1$, $\gls{sy:a}_2$, $\gls{sy:a}_3$) as expressed in frame $B$ ($\gls{sy:b}_1$, $\gls{sy:b}_2$, $\gls{sy:b}_3$).
In the case of both bases consisting of unit vectors, the \gls{ac:dcm} elements become equal to the cosine of the angle between each pair of basis vectors (see \cref{eqt:dcm_basis}), hence the name cosine matrix.
\begin{equation} \label{eqt:dcm_basis}
    \gls{sy:dcm}^{B/A} = \begin{bmatrix}
        \gls{sy:b}_1 \cdot \gls{sy:a}_1 & \gls{sy:b}_1 \cdot \gls{sy:a}_2 & \gls{sy:b}_1 \cdot \gls{sy:a}_3 \\
        \gls{sy:b}_2 \cdot \gls{sy:a}_1 & \gls{sy:b}_2 \cdot \gls{sy:a}_2 & \gls{sy:b}_2 \cdot \gls{sy:a}_3 \\
        \gls{sy:b}_3 \cdot \gls{sy:a}_1 & \gls{sy:b}_3 \cdot \gls{sy:a}_2 & \gls{sy:b}_3 \cdot \gls{sy:a}_3
    \end{bmatrix}
    =
    \begin{bmatrix}
        \cos \theta_{11} & \cos \theta_{12} & \cos \theta_{13} \\
        \cos \theta_{21} & \cos \theta_{22} & \cos \theta_{23} \\
        \cos \theta_{31} & \cos \theta_{32} & \cos \theta_{33}
    \end{bmatrix}
\end{equation}


\subsection{Euler Angles}
Euler angles are a set of three angles that represent an orientation, rotation or attitude as three successive, single axis rotations.
The rotations can be performed about any axis in any order, so long as no two rotations are about the same axis.
For each successive rotation is applied to the intermediate frame, resulting from the previous rotation.
This leads to two intermediate frames being created $A \overset{i}{\rightarrow} A' \overset{j \neq i}{\rightarrow} A'' \overset{k \neq j}{\rightarrow} B$.

Defining a triplet with rotation order $3 \rightarrow 2 \rightarrow 1$, any attitude can then be represented by a triplet of roll, pitch and yaw Euler angles (see \cref{eqt:ypr_attitude}).
\begin{equation} \label{eqt:ypr_attitude}
    \gls{sy:ypr} = \begin{bmatrix}
        \gls{sy:roll} \\
        \gls{sy:pitch} \\
        \gls{sy:yaw}
    \end{bmatrix}
\end{equation}


\subsubsection*{Euler Angles to DCM}
For any single axis rotation about axis $i$ with angle $\theta_i$, the rotation axis remains unchanged leaving $\gls{sy:a}_i = \gls{sy:b}_i$.
The resulting \glspl{ac:dcm} are given by \cref{eqt:c1,eqt:c2,eqt:c3}.

\parbox{.49\textwidth}{
\begin{equation} \label{eqt:c1}
    \gls{sy:c1}(\gls{sy:roll}) = \begin{bmatrix}
        1 & 0 & 0 \\
        0 & \cos(\gls{sy:roll}) & \sin(\gls{sy:roll}) \\
        0 & -\sin(\gls{sy:roll}) & \cos(\gls{sy:roll})
    \end{bmatrix}
\end{equation}
}
\parbox{.49\textwidth}{
\begin{equation} \label{eqt:c2}
    \gls{sy:c2}(\gls{sy:pitch}) = \begin{bmatrix}
        \cos(\gls{sy:pitch}) & 0 & -\sin(\gls{sy:pitch}) \\
        0 & 1 & 0 \\
        \sin(\gls{sy:pitch}) & 0 & \cos(\gls{sy:pitch})
    \end{bmatrix}
\end{equation}
}
\begin{equation} \label{eqt:c3}
    \gls{sy:c3}(\gls{sy:yaw}) = \begin{bmatrix}
        \cos(\gls{sy:yaw}) & \sin(\gls{sy:yaw}) & 0 \\
        -\sin(\gls{sy:yaw}) & \cos(\gls{sy:yaw}) & 0 \\
        0 & 0 & 1
    \end{bmatrix}
\end{equation}

Using a $3 \rightarrow 2 \rightarrow 1$ rotation sequence using the \glsfull{sy:yaw}, \glsfull{sy:pitch} and \glsfull{sy:roll}, the resulting \gls{ac:dcm} is given by \cref{eqt:dcm_euler}.
\begin{equation} \label{eqt:dcm_euler}
    \gls{sy:dcm}^{B/A} = \gls{sy:c1}(\gls{sy:roll}) \, \gls{sy:c2}(\gls{sy:pitch}) \, \gls{sy:c3}(\gls{sy:yaw})
\end{equation}


\subsection{Quaternions}
We define a quaternion \gls{sy:q} as a four-dimensional vector with one scalar and three vector components, as shown in \cref{eqt:quaternion}.
\begin{equation} \label{eqt:quaternion}
    \gls{sy:q} = \begin{bmatrix}
        q_0 \\
        q_1 \\
        q_2 \\
        q_3
    \end{bmatrix}
    =
    \begin{bmatrix}
        e_1 \, \sin(\frac{\theta}{2}) \\
        e_2 \, \sin(\frac{\theta}{2}) \\
        e_3 \, \sin(\frac{\theta}{2}) \\
        \cos(\frac{\theta}{2})
    \end{bmatrix}
\end{equation}
Where \gls{sy:e} is the unit vector of the eigenaxis of the rotation and \gls{sy:theta} is the rotation angle.

This definition allows for a representation of subsequent rotations as given in \cref{eqt:quaternion_product} without the use of trigonometric functions.
\begin{equation} \label{eqt:quaternion_product}
    \gls{sy:q}^B = \begin{bmatrix}
         q_4^{B/A} &  q_3^{B/A} & -q_2^{B/A} & q_1^{B/A} \\
        -q_3^{B/A} &  q_4^{B/A} &  q_1^{B/A} & q_2^{B/A} \\
         q_2^{B/A} & -q_1^{B/A} &  q_4^{B/A} & q_3^{B/A} \\
        -q_1^{B/A} & -q_2^{B/A} & -q_3^{B/A} & q_4^{B/A} 
    \end{bmatrix}    
    \,
    \begin{bmatrix}
        q_1^A \\
        q_2^A \\
        q_3^A \\
        q_4^A
    \end{bmatrix}
\end{equation}


\subsubsection*{Quaternions to DCM}
Using this definition of quaternions, the corresponding \gls{sy:dcm} for a given quaternion can be expressed as shown in \cref{eqt:quaternion_to_dcm}. 
\begin{equation} \label{eqt:quaternion_to_dcm}
    \gls{sy:dcm} = \begin{bmatrix}
        1 - 2(q_2^2 + q_3^2) & 2(q_1 q_2 + q_3 q_4) & 2(q_1 q_3 - q_2 q_4) \\
        2(q_1 q_2 + q_3 q_4) & 1 - 2(q_1^2 + q_3^2) & 2(q_2 q_3 + q_1 q_4) \\
        2(q_1 q_3 + q_2 q_4) & 2(q_2 q_3 - q_1 q_4) & 1 - 2(q_1^2 + q_2^2)
    \end{bmatrix}
\end{equation}

Inversely, the quaternion can be calculated from the \glsdesc{sy:dcm} as shown in \cref{eqt:dcm_to_quaternion}.
\begin{equation} \label{eqt:dcm_to_quaternion}
    \gls{sy:q} = \frac{1}{4 q_4} \begin{bmatrix}
        \gls{sy:dcm}_{23} - \gls{sy:dcm}_{32} \\
        \gls{sy:dcm}_{31} - \gls{sy:dcm}_{13} \\
        \gls{sy:dcm}_{12} - \gls{sy:dcm}_{21}
    \end{bmatrix}
\end{equation}


\subsubsection*{Single Axis Rotations}
Using the definition of single axis rotation in \gls{ac:dcm} representation (\cref{eqt:c1,eqt:c2,eqt:c3}), together with the relationship between \gls{sy:dcm} and quaternions (\cref{eqt:quaternion_to_dcm}), we can derive the single axis rotation matrices in quaternion representation as shown in \cref{eqt:quaternion_c1,eqt:quaternion_c2,eqt:quaternion_c3}.

\parbox{.32\textwidth}{
\begin{equation} \label{eqt:quaternion_c1}
    \gls{sy:q}^{C_1} = \begin{bmatrix}
        \sin \frac{\gls{sy:roll}}{2} \\
        0 \\
        0 \\
        \cos \frac{\gls{sy:roll}}{2}
    \end{bmatrix}
\end{equation}
}
\parbox{.32\textwidth}{
\begin{equation} \label{eqt:quaternion_c2}
    \gls{sy:q}^{C_2} = \begin{bmatrix}
        0 \\
        \sin \frac{\gls{sy:pitch}}{2} \\
        0 \\
        \cos \frac{\gls{sy:pitch}}{2}
    \end{bmatrix}
\end{equation}
}
\parbox{.32\textwidth}{
\begin{equation} \label{eqt:quaternion_c3}
    \gls{sy:q}^{C_3} = \begin{bmatrix}
        0 \\
        0 \\
        \sin \frac{\gls{sy:yaw}}{2} \\
        \cos \frac{\gls{sy:yaw}}{2}
    \end{bmatrix}
\end{equation}
}


\subsubsection*{Quaternions to Euler Angles}
Using the yaw $\rightarrow$ pitch $\rightarrow$ roll rotation sequence, the quaternion can be expressed as a function of the Euler angles using the single axis rotation quaternions (\cref{eqt:quaternion_c1,eqt:quaternion_c2,eqt:quaternion_c3}).
The resulting quaternion as shown in \cref{eqt:ypr_to_quaternion}.
\begin{equation} \label{eqt:ypr_to_quaternion}
    \gls{sy:q} = \begin{bmatrix}
        \sin \frac{\gls{sy:roll}}{2} \cos \frac{\gls{sy:pitch}}{2} \cos \frac{\gls{sy:yaw}}{2} 
        - \cos \frac{\gls{sy:roll}}{2} \sin \frac{\gls{sy:pitch}}{2} \sin \frac{\gls{sy:yaw}}{2}
        \\
        \cos \frac{\gls{sy:roll}}{2} \sin \frac{\gls{sy:pitch}}{2} \cos \frac{\gls{sy:yaw}}{2} 
        + \sin \frac{\gls{sy:roll}}{2} \cos \frac{\gls{sy:pitch}}{2} \sin \frac{\gls{sy:yaw}}{2}
        \\
        \cos \frac{\gls{sy:roll}}{2} \cos \frac{\gls{sy:pitch}}{2} \sin \frac{\gls{sy:yaw}}{2}
        - \sin \frac{\gls{sy:roll}}{2} \sin \frac{\gls{sy:pitch}}{2} \cos \frac{\gls{sy:yaw}}{2}
        \\
        \cos \frac{\gls{sy:roll}}{2} \cos \frac{\gls{sy:pitch}}{2} \cos \frac{\gls{sy:yaw}}{2}
        + \sin \frac{\gls{sy:roll}}{2} \sin \frac{\gls{sy:pitch}}{2} \sin \frac{\gls{sy:yaw}}{2}
    \end{bmatrix}
\end{equation}


\section{Kinematics}
\subsection{Angular Rates}


\section{Controller Design}
\subsection{Linearization}
\subsection{\texorpdfstring{\acrlong{pd}}{Proportional Differential} Controller}
\subsection{\texorpdfstring{\acrlong{ndi}}{Nonlinear Dynamic Inversion}}
\subsection{\texorpdfstring{\acrlong{tss}}{Time Scale Separation}}
\subsection{\texorpdfstring{\acrlong{indi}}{Incremental Dynamic Inversion}}


\chapter{Results}
\chapter{Discussion}


% back matter
\printglossary[type=\acronymtype]
\begingroup
    \let\clearpage\relax
    \printglossary[type=symbols, style=long3col]
\endgroup
\printbibliography

\end{document}
